package indi.kanouakira.iec102;

import indi.kanouakira.iec102.core.Iec102DataConfig;
import indi.kanouakira.iec102.core.Iec102UploadFile;
import indi.kanouakira.iec102.core.enums.TypeIdentificationEnum;
import indi.kanouakira.iec102.util.ByteUtil;

import java.util.Calendar;
import java.util.Date;

import static indi.kanouakira.iec102.server.secondary.SecondaryStationFactory.createSecondaryStation;
import static indi.kanouakira.iec102.standard.StandardProtocolEnum.IEC102;

/**
 * 启动类。
 *
 * @author KanouAkira
 * @date 2022/5/6 16:56
 */
public class Application {
    public static void main(String[] args) throws Exception {
        // 构造一个文件，传入作为测试，启动5分钟后过期。
        byte[] fileContext = ByteUtil.hexStringToBytes("3C2153797374656D3D4F4D530956657273696F6E3D312E3009436F64653D5554462D3809446174613D312E30213E0A2F2FB9E2B7FCCFE4B1E4BCE0B2E20A3C58423A3A475A2E5A686F6E6742444309446174653D27323032312D31312D3135270954696D653D2731302D31352D3030273E0A4009D0F2BAC509CFE4B1E4B1E0BAC509CFE4B1E4B5CDD1B9B2E0B5E7D1B9556109CFE4B1E4B5CDD1B9B2E0B5E7C1F7496109CFE4B1E4B5CDD1B9B2E0D3D0B9A6B9A6C2CA09CFE4B1E4B8DFD1B9B2E0B5E7D1B9556109CFE4B1E4B8DFD1B9B2E0B5E7D1B9556209CFE4B1E4B8DFD1B9B2E0B5E7D1B9556309CFE4B1E4B8DFD1B9B2E0B5E7D1B955616209CFE4B1E4B8DFD1B9B2E0B5E7D1B955626309CFE4B1E4B8DFD1B9B2E0B5E7D1B955636109CFE4B1E4B8DFD1B9B2E0B5E7C1F7496109CFE4B1E4B8DFD1B9B2E0B5E7C1F7496209CFE4B1E4B8DFD1B9B2E0B5E7C1F7496309CFE4B1E4B8DFD1B9B2E0D3D0B9A6B9A6C2CA09CFE4B1E4B8DFD1B9B2E0CEDEB9A6B9A6C2CA09CFE4B1E4B8DFD1B9B2E0B9A6C2CAD2F2CAFD09CFE4B1E4C8C6D7E9CEC2B6C809C8D5B7A2B5E7C1BF09D4C2B7A2B5E7C1BF09C4EAB7A2B5E7C1BF09C0DBBCC6B7A2B5E7C1BF09CFE4B1E4A3A8B7BDD5F3A3A9C0EDC2DBD7EEB4F3D3D0B9A6B9A6C2CA09CFE4B1E4CEDEB9A6CAE4B3F6B7B6CEA709CFE4B1E4B2A2CDF8D4CBD0D0D7B4CCAC09CFE4B1E4B9CAD5CFD7B4CCAC09CFE4B1E4BCECD0DE09CFE4B1E4CFDEB5E709D6B1C1F7B9FDD1B909BDBBC1F7B9FDD1B909BDBBC1F7C7B7D1B9097878B1A3BBA4B6AFD7F7BCB0B8E6BEAFD0C5BAC5090A2309310923310932312E36303738333935383433353036093132382E31313935333733353335313609382E3037313734333031313437343631096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C090A230932092332096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C090A230933092333096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C096E756C6C090A3C2F58423A3A475A2E5A686F6E674244433E0A0A2F2FB7BDD5F3BCE0B2E20A3C465A3A3A475A2E5A686F6E6742444309446174653D27323032312D31312D3135270954696D653D2731302D31352D3030273E0A4009D0F2BAC509B7BDD5F3B1E0BAC509B7BDD5F3D6B1C1F7CAE4C8EBB5E7C1F709B7BDD5F3D6B1C1F7CAE4B3F6B5E7C1F709B7BDD5F3D6B1C1F7C4B8CFDFB5E7D1B9090A230931092331093132382E313139353337333533353136093132362E3034383731333638343038320933372E34343031323435313137313838090A230932092332096E756C6C096E756C6C096E756C6C090A230933092333096E756C6C096E756C6C096E756C6C090A3C2F465A3A3A475A2E5A686F6E674244433E0A0A");
        Calendar instance = Calendar.getInstance();
        instance.setTime(new Date());
        instance.add(Calendar.MINUTE,  5);
        Iec102UploadFile iec102UploadFile = new Iec102UploadFile(TypeIdentificationEnum.ZTXX_QXHJ, "GF_GZ.ZhongBDC_XB-FZ_20211115_101500.dat", fileContext, instance.getTime());
        Iec102DataConfig.addFile(iec102UploadFile);

        createSecondaryStation(3000, IEC102).run();
    }
}
